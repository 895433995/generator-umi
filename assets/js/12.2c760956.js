(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{259:function(s,t,a){"use strict";a.r(t);var e=a(32),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由"}},[s._v("#")]),s._v(" 路由")]),s._v(" "),a("p",[s._v("脚手架使用"),a("a",{attrs:{href:"https://umijs.org/docs/convention-routing",target:"_blank",rel:"noopener noreferrer"}},[s._v("约定式路由"),a("OutboundLink")],1),s._v("，并对其功能进行了扩展。并通过内置的布局处理器做最终渲染确定。")]),s._v(" "),a("h2",{attrs:{id:"路由扩展属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由扩展属性"}},[s._v("#")]),s._v(" 路由扩展属性")]),s._v(" "),a("p",[s._v("扩展属性使用方法：只要在页面组件中，设置静态属性即可。完整示例如下：")]),s._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" React "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'react'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Analysis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("analysis"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nAnalysis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ANALYSIS_TITLE'")]),s._v("\nAnalysis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("layout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'PRO_LAYOUT'")]),s._v("\nAnalysis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("requireSignin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nAnalysis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("access "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'canReadDashboardAnalysis'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" Analysis\n")])])]),a("blockquote",[a("p",[s._v("静态属性：指 直接赋值的 属性，例如："),a("code",[s._v("Login.title = 'LOGIN_TITLE'")]),s._v("。"),a("s",[s._v("变量中转则不支持，如："),a("code",[s._v("Login.title = titleName")])])])]),s._v(" "),a("h3",{attrs:{id:"title"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#title"}},[s._v("#")]),s._v(" title")]),s._v(" "),a("ul",[a("li",[s._v("Type: "),a("code",[s._v("string")])])]),s._v(" "),a("p",[s._v("可直接使用国际化 "),a("code",[s._v("key")]),s._v("，自动被转成对应语言的文案。")]),s._v(" "),a("h3",{attrs:{id:"layout"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#layout"}},[s._v("#")]),s._v(" layout")]),s._v(" "),a("ul",[a("li",[s._v("Type: "),a("code",[s._v("string")])])]),s._v(" "),a("p",[s._v("路由必须指定自己使用的布局，目前内置有 "),a("code",[s._v("BLANK")]),s._v(", "),a("code",[s._v("PRO_LAYOUT")]),s._v(" 两款布局。")]),s._v(" "),a("p",[s._v("如下图风格：")]),s._v(" "),a("p",[a("strong",[s._v("BLANK")]),s._v(" 空布局")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/blank_layout.png"),alt:"blank"}}),s._v(" "),a("p",[a("strong",[s._v("PRO_LAYOU")]),s._v(" ant-design-pro 布局")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/pro_layout.png"),alt:"pro"}}),s._v(" "),a("h3",{attrs:{id:"requiresignin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requiresignin"}},[s._v("#")]),s._v(" requireSignin")]),s._v(" "),a("ul",[a("li",[s._v("Type: "),a("code",[s._v("boolean")])])]),s._v(" "),a("p",[s._v("指定路由是否需要登录。")]),s._v(" "),a("p",[s._v("当一个路由的 "),a("code",[s._v("requireSignin")]),s._v(" 指定为 "),a("code",[s._v("true")]),s._v("，如果用户未登录时访问该路由，回重定向到登录页面。")]),s._v(" "),a("p",[s._v("当一个路由的 "),a("code",[s._v("requireSignin")]),s._v(" 指定为 "),a("code",[s._v("false")]),s._v("，用户是否登录，不影响路由访问。")]),s._v(" "),a("h3",{attrs:{id:"access"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#access"}},[s._v("#")]),s._v(" access")]),s._v(" "),a("ul",[a("li",[s._v("Type: "),a("code",[s._v("string")])])]),s._v(" "),a("p",[s._v("当路由的 "),a("code",[s._v("requireSignin = true")]),s._v(" 时，可以设置 "),a("code",[s._v("access")]),s._v(" 来描述该路由的详细权限诉求。")]),s._v(" "),a("p",[s._v("例如分析页面 "),a("code",[s._v("src/pages/dashboard/analysis/index.tsx")]),s._v("，该路由指定了 "),a("code",[s._v("Analysis.access = 'canReadDashboardAnalysis'")]),s._v("。")]),s._v(" "),a("p",[s._v("这时候，如果我们把 "),a("code",[s._v("mock/user.js")]),s._v(" 中的 "),a("code",[s._v("VIEW_DASHBOARD_ANALYSIS")]),s._v(" 改成其他任意字符，刷新页面，尝试访问 "),a("code",[s._v("/dashboard/analysis")]),s._v("，你会看到如下界面：")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/403.png"),alt:"403"}}),s._v(" "),a("blockquote",[a("p",[s._v("判定是否具有页面访问权限的操作之所以单独放在 "),a("code",[s._v("src/access.ts")]),s._v(" 里，就是考虑到后端的 api 不一定和脚手架相同而需要变更，所以在 "),a("code",[s._v("src/access.ts")]),s._v(" 里统一处理。")])]),s._v(" "),a("p",[s._v("那么，如果页面没有额外的权限要求，仅登录后就能访问，例如：个人信息页。该如何处理？简单，只要不给 "),a("code",[s._v("access")]),s._v(" 赋值就可以了。")]),s._v(" "),a("h2",{attrs:{id:"不存在路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不存在路由"}},[s._v("#")]),s._v(" 不存在路由")]),s._v(" "),a("p",[s._v("如果访问的页面不存在，脚手架自带了 404 组件，如下：")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/open_404.png"),alt:"open 404"}}),s._v(" "),a("h2",{attrs:{id:"权限路由的应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#权限路由的应用"}},[s._v("#")]),s._v(" 权限路由的应用")]),s._v(" "),a("p",[s._v("分别使用 "),a("code",[s._v("admin/123456")]),s._v(" 和 "),a("code",[s._v("meimei.han/123456")]),s._v(" 两个账号登录系统，会看到不同的菜单。")])])}),[],!1,null,null,null);t.default=r.exports}}]);